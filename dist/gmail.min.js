var Gmail=function(){var api={get:{},observe:{},check:{},tools:{},tracker:{},dom:{}};return api.version="0.2.3",api.tracker.globals=GLOBALS,api.tracker.view_data=VIEW_DATA,api.tracker.ik=api.tracker.globals[9],api.get.last_active=function(){var e=api.tracker.globals[17][15];return{time:e[1],ip:e[3],mac_address:e[9],time_relative:e[10]}},api.get.loggedin_accounts=function(){var e=api.tracker.globals[17][23],t=[];for(i in e[1])t.push({name:e[1][i][4],email:e[1][i][0]});return t},api.get.user_email=function(){return api.tracker.globals[10]},api.check.is_thread=function(){var e=$(".nH .if").children(":eq(1)").children().children(":eq(1)").children(),t=api.get.email_ids();return e.length>1||t.length>1},api.dom.inbox_content=function(){return $("div[role=main]:first")},api.check.is_preview_pane=function(){var e=api.dom.inbox_content(),t=e.find("[gh=tl]"),n=!1;return t.each(function(){$(this).hasClass("aia")&&(n=!0)}),n},api.dom.inboxes=function(){var e=api.dom.inbox_content();return e.find("[gh=tl]")},api.check.is_multiple_inbox=function(){var e=api.dom.inboxes();return e.length>1},api.check.is_horizontal_split=function(){var e=api.dom.inbox_content(),t=e.find("[gh=tl]").find(".nn");return t.length==0},api.check.is_vertical_split=function(){return api.check.is_horizontal_split()==0},api.check.is_tabbed_inbox=function(){return $(".aKh").length==1},api.check.is_right_side_chat=function(){return $(".ApVoH")[0].getAttribute("aria-labelledby")==":wf"},api.check.is_google_apps_user=function(){var e=api.get.user_email();return e.indexOf("gmail.com",e.length-"gmail.com".length)==-1},api.get.storage_info=function(){var e=$(".md.mj").find("div")[0],t=$(e).find("span")[0].innerText,n=$(e).find("span")[1].innerText,r=parseFloat(t.replace(/[^0-9\.]/g,""))*100/parseFloat(n.replace(/[^0-9\.]/g,""));return{used:t,total:n,percent:Math.floor(r)}},api.dom.email_subject=function(){var e=$(".hP");for(var t=0;t<e.length;t++)if($(e[t]).is(":visible"))return e[t];return null},api.get.email_subject=function(){var e=api.dom.email_subject();return e.find(".hP")[0].innerText},api.dom.email_body=function(){return $(".nH.hx")},api.check.is_inside_email=function(){if(api.get.current_page()!=null&&!api.check.is_preview_pane())return!1;var e=$(".ii.gt"),t=[];for(var n=0;n<e.length;n++){var r=e[n].getAttribute("class").split(" ")[2];r!="undefined"&&r!=undefined&&$(e[n]).is(":visible")&&t.push(e[n])}return t.length>0},api.dom.email_contents=function(){var e=$(".ii.gt"),t=[];for(var n=0;n<e.length;n++){var r=e[n].getAttribute("class").split(" ")[2],i=e[n].getAttribute("contenteditable");r!="undefined"&&r!=undefined&&i!="true"&&t.push(e[n])}return t},api.get.email_ids=function(){if(api.check.is_inside_email()){var e=api.get.email_data();return Object.keys(e.threads)}return[]},api.get.email_id=function(){var e=null;if(api.check.is_inside_email())if(api.check.is_preview_pane()){var t=api.dom.email_contents(),n=[];for(var r=0;r<t.length;r++){var i=t[r].getAttribute("class").split(" ")[2],s=t[r].getAttribute("contenteditable");i!="undefined"&&i!=undefined&&s!="true"&&n.push(i)}e=n[0].substring(1,n[0].length)}else e=window.location.hash.split("/").pop().replace(/#/,"").split("?")[0];return e},api.check.is_priority_inbox=function(){return $(".qh").length>0},api.check.is_rapportive_installed=function(){return $("#rapportive-sidebar").length==1},api.check.is_streak_installed=function(){return $("[id^='bentoBox'],[id*=' bentoBox'],[class*=' bentoBox'],[class*='bentoBox']").length>0},api.check.is_anydo_installed=function(){return $("[id^='anydo'],[id*=' anydo'],[class*=' anydo'],[class*='anydo']").length>0},api.check.is_boomerang_installed=function(){return $("[id^='b4g_'],[id*=' b4g_'],[class*=' b4g_'],[class*='b4g_']").length>0},api.check.is_xobni_installed=function(){return $("#xobni_frame").length>0},api.check.is_signal_installed=function(){return $("[id^='Signal'],[id*=' Signal'],[class*=' signal'],[class*='signal']").length>0},api.dom.get_left_sidebar_links=function(){return $("div[role=navigation] [title]")},api.dom.search_bar=function(){return $("[gh=sb]")},api.get.search_query=function(){var e=api.dom.search_bar();return e.find("input")[0].value},api.get.unread_inbox_emails=function(){var e=$("div[role=navigation]").find("[title*='Inbox']");return e.length>0&&e[0].innerText.indexOf("(")!=-1?parseInt(e[0].innerText.replace(/[^0-9]/g,"")):0},api.get.unread_draft_emails=function(){var e=$("div[role=navigation]").find("[title*='Drafts']");return e.length>0&&e[0].innerText.indexOf("(")!=-1?parseInt(e[0].innerText.replace(/[^0-9]/g,"")):0},api.get.unread_spam_emails=function(){var e=$("div[role=navigation]").find("[title*='Spam']");return e.length>0&&e[0].innerText.indexOf("(")!=-1?parseInt(e[0].innerText.replace(/[^0-9]/g,"")):0},api.get.unread_forum_emails=function(){var e=$("div[role=navigation]").find("[title*='Forums']");return e.length>0&&e[0].innerText.indexOf("(")!=-1?parseInt(e[0].innerText.replace(/[^0-9]/g,"")):0},api.get.unread_notification_emails=function(){var e=$("div[role=navigation]").find("[title*='Notifications']");return e.length>0&&e[0].innerText.indexOf("(")!=-1?parseInt(e[0].innerText.replace(/[^0-9]/g,"")):0},api.get.unread_promotion_emails=function(){var e=$("div[role=navigation]").find("[title*='Promotions']");return e.length>0&&e[0].innerText.indexOf("(")!=-1?parseInt(e[0].innerText.replace(/[^0-9]/g,"")):0},api.get.unread_social_emails=function(){var e=$("div[role=navigation]").find("[title*='Social Updates']");return e.length>0&&e[0].innerText.indexOf("(")!=-1?parseInt(e[0].innerText.replace(/[^0-9]/g,"")):0},api.get.beta=function(){var e={new_nav_bar:$("#gbz").length==0};return e},api.get.unread_emails=function(){return{inbox:api.get.unread_inbox_emails(),drafts:api.get.unread_draft_emails(),spam:api.get.unread_spam_emails(),forum:api.get.unread_forum_emails(),notifications:api.get.unread_notification_emails(),promotions:api.get.unread_promotion_emails(),social:api.get.unread_social_emails()}},api.tools.parse_url=function(e){var t=/[?&]([^=#]+)=([^&#]*)/g,n={},r;while(r=t.exec(e))n[r[1]]=r[2];return n},api.tools.sleep=function(e){var t=(new Date).getTime();for(;;)if((new Date).getTime()-t>e)break},api.tools.multitry=function(e,t,n,r,i,s){if(i!=undefined&&i>=t)return s;var i=i==undefined?0:i,o=n();if(r(o))return o;api.tools.sleep(e),api.tools.multitry(e,t,n,r,i+1,o)},api.tools.deparam=function(e,t){if(e instanceof File)return{};var n=function(e,t){var n=[];for(i=0;i<e.length;i++)n.push(t(e[i]));return n},r=Array.isArray||function(e){return Object.prototype.toString.call(e)=="[object Array]"},s={},o={"true":!0,"false":!1,"null":null};return n(e.replace(/\+/g," ").split("&"),function(e,n){var i=e.split("="),u=decodeURIComponent(i[0]),a,f=s,l=0,c=u.split("]["),h=c.length-1;/\[/.test(c[0])&&/\]$/.test(c[h])?(c[h]=c[h].replace(/\]$/,""),c=c.shift().split("[").concat(c),h=c.length-1):h=0;if(i.length===2){a=decodeURIComponent(i[1]),t&&(a=a&&!isNaN(a)?+a:a==="undefined"?undefined:o[a]!==undefined?o[a]:a);if(h)for(;l<=h;l++)u=c[l]===""?f.length:c[l],f=f[u]=l<h?f[u]||(c[l+1]&&isNaN(c[l+1])?{}:[]):a;else r(s[u])?s[u].push(a):s[u]!==undefined?s[u]=[s[u],a]:s[u]=a}else u&&(s[u]=t?undefined:"")}),s},api.tools.parse_actions=function(e){e.method=="POST"&&typeof e.url.act=="string",e.url.search!=undefined;var t={tae:"add_to_tasks","rc_^i":"archive",tr:"delete",dl:"delete_forever",dc_:"delete_label",dd:"discard_draft",el:"expand_categories",cffm:"filter_messages_like_these",arl:"label",mai:"mark_as_important",mani:"mark_as_not_important",us:"mark_as_not_spam",sp:"mark_as_spam",mt:"move_label",ib:"move_to_inbox",ig:"mute",rd:"read",sd:"save_draft",sm:"send_message",mo:"show_newly_arrived_message",st:"star",ug:"unmute",ur:"unread",xst:"unstar",new_mail:"new_email",poll:"poll",refresh:"refresh",open_email:"open_email"};typeof e.url.ik=="string"&&(api.tracker.ik=e.url.ik),typeof e.url.rid=="string"&&e.url.rid.indexOf("mail")!=-1&&(api.tracker.rid=e.url.rid);var n=decodeURIComponent(e.url.act),r=api.tools.deparam(e.body),i=typeof r.t=="string"?[r.t]:r.t,s=null;switch(n){case"ur":var s=[i,e.url,e.body];break;case"rd":var s=[i,e.url,e.body];break;case"tr":var s=[i,e.url,e.body];break;case"sp":var s=[i,e.url,e.body];break;case"us":var s=[i,e.url,e.body];break;case"arl":var s=[i,e.url,e.body,e.url.acn];break;case"ib":var s=[i,e.url,e.body];break;case"dl":var s=[i,e.url,e.body];break;case"st":var s=[i,e.url,e.body];break;case"xst":var s=[i,e.url,e.body];break;case"mai":var s=[i,e.url,e.body];break;case"mani":var s=[i,e.url,e.body];break;case"ig":var s=[i,e.url,e.body];break;case"ug":var s=[i,e.url,e.body];break;case"sd":var s=[i,e.url,r];break;case"dd":var s=[i,e.url,e.body];break;case"mt":var s=[i,e.url,e.body];break;case"tae":var s=[e.url,e.body,r];break;case"cffm":var s=[i,e.url,e.body];break;case"rc_^i":var s=[i,e.url,e.body];break;case"sm":var s=[e.url,e.body,r];break;case"el":var s=[e.url,e.body,r.ex=="1"]}if(typeof e.url._reqid=="string"&&typeof e.url.th=="string"){var s=[e.url.th,e.url,e.body];"new_email"in api.tracker.watchdog&&api.tracker.watchdog.new_email.apply(undefined,s)}if((e.url.view=="cv"||e.url.view=="ad")&&typeof e.url.th=="string"&&typeof e.url.search=="string"&&e.url.rid==undefined){var s=[e.url.th,e.url,e.body];"open_email"in api.tracker.watchdog&&api.tracker.watchdog.open_email.apply(undefined,s)}if(typeof e.url.SID=="string"&&typeof e.url.zx=="string"&&e.body.indexOf("req0_")!=-1){api.tracker.SID=e.url.SID;var s=[e.url,e.body,r];"poll"in api.tracker.watchdog&&api.tracker.watchdog.poll.apply(undefined,s)}if(typeof e.url.ik=="string"&&typeof e.url.search=="string"&&e.body.length==0&&typeof e.url._reqid=="string"){var s=[e.url,e.body,r];"refresh"in api.tracker.watchdog&&api.tracker.watchdog.refresh.apply(undefined,s)}s!=null&&t[n]in api.tracker.watchdog&&api.tracker.watchdog[t[n]].apply(undefined,s)},api.tools.parse_requests=function(e){e.url_raw=e.url,e.url=api.tools.parse_url(e.url),typeof api.tracker.events!="object"&&typeof api.tracker.actions!="object"&&(api.tracker.events=[],api.tracker.actions=[]),api.tracker.events.unshift(e),api.tools.parse_actions(e),e.method=="POST"&&typeof e.url.act=="string"&&api.tracker.actions.unshift(e),api.tracker.events.length>50&&api.tracker.events.pop(),api.tracker.actions.length>10&&api.tracker.actions.pop()},api.tools.xhr_watcher=function(){var e=this;if(!api.tracker.xhr_init){var t=top.document.getElementById("js_frame").contentDocument.defaultView;api.tracker.xhr_init=!0,api.tracker.xhr_open=t.XMLHttpRequest.prototype.open,api.tracker.xhr_send=t.XMLHttpRequest.prototype.send,t.XMLHttpRequest.prototype._gjs_open=t.XMLHttpRequest.prototype.open,t.XMLHttpRequest.prototype.open=function(e,t,n,r,i){var s=this._gjs_open.apply(this,arguments);return this.xhrParams={method:e.toString(),url:t.toString()},s},t.XMLHttpRequest.prototype._gjs_send=t.XMLHttpRequest.prototype.send,t.XMLHttpRequest.prototype.send=function(e){var t=this._gjs_send.apply(this,arguments);if(this.xhrParams){this.xhrParams.body=e;try{api.tools.parse_requests(this.xhrParams)}catch(n){console.log(n)}}return t}}},api.observe.http_requests=function(){return api.tracker.events},api.observe.actions=function(){return api.tracker.actions},api.observe.on=function(e,t){typeof api.tracker.watchdog!="object"&&(api.tracker.watchdog={}),api.tracker.xhr_init||api.tools.xhr_watcher(),api.tracker.watchdog[e]=t},api.observe.off=function(e){if(e)"watchdog"in api.tracker&&e in api.tracker.watchdog&&delete api.tracker.watchdog[e];else{var t=top.document.getElementById("js_frame").contentDocument.defaultView;t.XMLHttpRequest.prototype.open=api.tracker.xhr_open,t.XMLHttpRequest.prototype.send=api.tracker.xhr_send,api.tracker.xhr_init=!1}},api.tools.make_request=function(e,t){var t=typeof t==undefined||typeof t==null?"GET":t,n=$.ajax({type:t,url:encodeURI(e),async:!1});return n.responseText},api.tools.parse_view_data=function(e){var t=[],n=[];for(var r=0;r<e.length;r++)if(e[r][0]=="tb")for(var i=0;i<e[r][2].length;i++)n.push(e[r][2][i]);for(var s=0;s<n.length;s++){var o=n[s],u={};t.push({id:o[0],title:o[9],excerpt:o[10],time:o[15],sender:o[28],attachment:o[13],labels:o[5]})}return t},api.get.visible_emails=function(){var page=api.get.current_page(),url=window.location.origin+window.location.pathname+"?ui=2&ik="+api.tracker.ik+"&rid="+api.tracker.rid+"&view=tl&start=0&num=120&rt=1";page.indexOf("label/")==0?url+="&cat="+page.split("/")[1]+"&search=cat":page.indexOf("category/")==0?(page.indexOf("forums")!=-1?cat_label="group":page.indexOf("updates")!=-1?cat_label="notification":page.indexOf("promotion")!=-1?cat_label="promo":page.indexOf("social")!=-1&&(cat_label="social"),url+="&cat=^smartlabel_"+cat_label+"&search=category"):page.indexOf("search/")==0?url+="&qs=true&q="+page.split("/")[1]+"&search=query":url+="&search="+page;var get_data=api.tools.make_request(url);get_data=get_data.substring(get_data.indexOf("["),get_data.length),get_data="api.tracker.view_data = "+get_data,eval(get_data);var emails=[];for(i in api.tracker.view_data){var cdata=api.tools.parse_view_data(api.tracker.view_data[i]);cdata.length>0&&$.merge(emails,cdata)}return emails},api.get.current_page=function(){var e=window.location.hash.split("#").pop(),t=["sent","inbox","starred","drafts","imp","chats","all","spam","trash"],n=null;return $.inArray(e,t)>-1&&(n=e),(e.indexOf("label/")==0||e.indexOf("category/")==0||e.indexOf("search/")==0)&&e.split("/").length<3&&(n=e),n},api.tools.parse_email_data=function(e){var t={},n={};for(i in e){var r=e[i];r[0]=="cs"&&(t.first_email=r[1],t.last_email=r[2],t.total_emails=r[3],t.total_threads=r[8],t.people_involved=r[15],t.subject=r[23]),r[0]=="ms"&&(t.threads==undefined&&(t.threads={}),t.threads[r[1]]={},t.threads[r[1]].reply_to_id=r[2],t.threads[r[1]].from=r[5],t.threads[r[1]].from_email=r[6],t.threads[r[1]].timestamp=r[7],t.threads[r[1]].datetime=r[24],t.threads[r[1]].content_plain=r[8],t.threads[r[1]].subject=r[12],t.threads[r[1]].content_html=r[13]!=undefined?r[13][6]:r[8],t.threads[r[1]].to=r[13]!=undefined?r[13][1]:[],t.threads[r[1]].cc=r[13]!=undefined?r[13][2]:[],t.threads[r[1]].bcc=r[13]!=undefined?r[13][3]:[])}return t},api.get.email_data=function(email_id){api.check.is_inside_email()&&email_id==undefined&&(email_id=api.get.email_id());if(email_id!=undefined){var url=window.location.origin+window.location.pathname+"?ui=2&ik="+api.tracker.ik+"&rid="+api.tracker.rid+"&view=cv&th="+email_id+"&msgs=&mb=0&rt=1&search=inbox",get_data=api.tools.make_request(url);return get_data=get_data.substring(get_data.indexOf("["),get_data.length),get_data="var cdata = "+get_data,eval(get_data),api.tracker.email_data=cdata[0],api.tools.parse_email_data(api.tracker.email_data)}return{}},api};